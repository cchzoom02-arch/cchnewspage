<!doctype html>
<html lang="zh-Hant">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>æ–°èç™¼å¸ƒæ¥­å‹™é€²åº¦</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;800&amp;display=swap" rel="stylesheet">
  <style>
  body {
    box-sizing: border-box;
  }
  :root{
    --ink:#111111;
    --muted:#6B7280;
    --line:#E6E6E6;
    --accent:#D80000;
    --soft-red:#FFFAFA;
    --soft-red-line:#FFDDDD;
    --blue:#2563EB;
    --green:#059669;
    --purple:#7C3AED;
    --soft-purple:#F8F5FF;
    --soft-purple-line:#E0D4FF;
  }
  *{box-sizing:border-box}
  body{
    font-family:"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
    color:var(--ink); background:#fff; margin:0; line-height:1.5;
  }
  .wrap{max-width:1200px;margin:40px auto;padding:0 24px}
  h1{font-weight:800;font-size:52px;letter-spacing:.5px;text-align:center;margin:0 0 28px}
  
  /* åŸå§‹å¡ç‰‡æ¨£å¼ */
  .card{
    display:grid; grid-template-columns:140px 1fr 240px; gap:24px;
    border:2px solid var(--line); border-radius:16px; padding:16px 20px; margin:0 0 20px;
    background:#fff; position:relative;
  }
  .card.accent{border-color:var(--soft-red-line); background:var(--soft-red)}
  .card.purple{border-color:var(--soft-purple-line); background:var(--soft-purple)}
  .date{
    padding-right:20px; border-right:2px solid var(--line);
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    text-align:center;
  }
  .date .label,.date .weekday{font-size:14px;color:var(--muted);letter-spacing:1px}
  .date .day{font-size:56px;font-weight:800;line-height:1}
  .card.accent .date .label,
  .card.accent .date .day,
  .card.accent .date .weekday{color:var(--accent)}
  .card.purple .date .label,
  .card.purple .date .day,
  .card.purple .date .weekday{color:var(--purple)}
  .content{display:flex; align-items:center}
  .content h2{margin:0; font-size:40px; line-height:1.15; font-weight:800}
  .content h2.red{color:var(--accent)}
  .content h2.purple{color:var(--purple)}
  .meta{
    padding-left:20px; border-left:2px solid var(--line);
    background:#F7F7F7; border-radius:12px; padding:12px 16px; display:flex; flex-direction:column; justify-content:center
  }
  .meta .row{margin:4px 0; font-size:16px}
  .meta .key{color:var(--muted); margin-right:6px}

  /* ç®¡ç†åŠŸèƒ½æ¨£å¼ */
  .admin-btn{
    position:fixed; top:20px; right:20px; 
    background:var(--blue); color:white; border:none; padding:12px 20px; 
    border-radius:8px; cursor:pointer; font-size:14px; font-weight:600;
    box-shadow:0 4px 12px rgba(37,99,235,0.3); z-index:100;
  }
  .admin-btn:hover{background:#1d4ed8}

  .edit-btn{
    position:absolute; top:16px; right:16px;
    background:var(--green); color:white; border:none; padding:8px 12px;
    border-radius:6px; cursor:pointer; font-size:12px; opacity:0; transition:opacity 0.3s;
    display:none;
  }
  .admin-mode .edit-btn{opacity:1; display:block}
  .edit-btn:hover{background:#047857}

  .add-btn{
    background:var(--blue); color:white; border:none; padding:16px 32px;
    border-radius:12px; cursor:pointer; font-size:16px; font-weight:600;
    margin:20px auto; display:none; box-shadow:0 4px 12px rgba(37,99,235,0.3);
  }
  .admin-mode .add-btn{display:block}
  .add-btn:hover{background:#1d4ed8}

  /* æ¨¡æ…‹æ¡†æ¨£å¼ */
  .modal{
    display:none; position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;
  }
  .modal.show{display:flex}
  .modal-content{
    background:white; padding:32px; border-radius:16px; width:500px; max-width:90%;
    box-shadow:0 20px 60px rgba(0,0,0,0.3); max-height:90vh; overflow-y:auto;
  }
  .modal h3{margin:0 0 24px; font-size:24px; text-align:center; font-weight:800}
  
  .form-group{margin:20px 0}
  .form-group label{display:block; margin-bottom:8px; font-weight:600; color:var(--ink)}
  .form-group input, .form-group select, .form-group textarea{
    width:100%; padding:12px 16px; border:2px solid var(--line); border-radius:8px;
    font-size:16px; font-family:inherit; transition:border-color 0.3s;
  }
  .form-group input:focus, .form-group select:focus, .form-group textarea:focus{
    outline:none; border-color:var(--blue);
  }
  .form-group textarea{resize:vertical; min-height:100px}
  
  .btn{
    background:var(--blue); color:white; border:none; padding:12px 24px;
    border-radius:8px; cursor:pointer; font-size:16px; font-weight:600; margin:8px 4px;
    transition:background-color 0.3s;
  }
  .btn:hover{background:#1d4ed8}
  .btn.secondary{background:var(--muted)}
  .btn.secondary:hover{background:#4b5563}
  .btn.danger{background:var(--accent)}
  .btn.danger:hover{background:#b91c1c}

  /* äººå“¡ç®¡ç†æ¨£å¼ */
  .staff-section{
    margin:24px 0; padding:20px; background:#f8f9fa; border-radius:12px;
  }
  .staff-section h4{margin:0 0 16px; font-size:18px; font-weight:600}
  .staff-list{
    display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:12px; margin:16px 0;
  }
  .staff-item{
    background:white; padding:12px 16px; border-radius:8px; border:1px solid var(--line);
    display:flex; justify-content:space-between; align-items:center;
  }
  .remove-staff{
    background:var(--accent); color:white; border:none; padding:6px 12px;
    border-radius:4px; cursor:pointer; font-size:12px;
  }
  .remove-staff:hover{background:#b91c1c}

  /* æª”æ¡ˆä¸Šå‚³æ¨£å¼ */
  .file-upload{
    border:2px dashed var(--line); border-radius:8px; padding:30px;
    text-align:center; cursor:pointer; transition:all 0.3s;
    background:#fafafa;
  }
  .file-upload:hover{border-color:var(--blue); background:#f0f8ff}
  .file-upload input{display:none}
  .file-upload p{margin:0; color:var(--muted)}
  .file-upload small{color:var(--muted); font-size:12px}

  .checkbox-group{
    display:flex; align-items:center; gap:8px; margin:16px 0;
  }
  .checkbox-group input[type="checkbox"]{
    width:auto; margin:0;
  }

  @media (max-width:900px){
    .card{grid-template-columns:1fr; }
    .date{border-right:0; border-bottom:2px solid var(--line); padding-bottom:12px; margin-bottom:8px}
    .meta{border-left:0; margin-top:8px}
    .content h2{font-size:28px}
    .date .day{font-size:42px}
    .modal-content{width:95%; padding:20px}
    .admin-btn{position:static; margin:20px auto; display:block; width:fit-content}
  }
</style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><button class="admin-btn" onclick="showLoginModal()">ç®¡ç†å¾Œå°</button>
  <div class="wrap">
   <h1>æ–°èç™¼å¸ƒæ¥­å‹™é€²åº¦</h1>
   <div style="text-align:center; margin:20px 0"><button class="add-btn" onclick="addNews()">+ æ–°å¢æ–°è</button> <button class="add-btn" onclick="showHistoryModal()" style="background:var(--muted); margin-left:12px">ğŸ“š æ­·å²ç´€éŒ„</button>
   </div>
   <div id="newsContainer"></div>
  </div><div id="loginModal" class="modal">
   <div class="modal-content">
    <h3>ğŸ” ç®¡ç†å“¡ç™»å…¥</h3>
    <div class="form-group"><label>è«‹è¼¸å…¥ç®¡ç†å¯†ç¢¼ï¼š</label> <input type="password" id="adminPassword" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" onkeypress="if(event.key==='Enter') login()">
    </div>
    <div style="text-align:center"><button class="btn" onclick="login()">ç™»å…¥</button> <button class="btn secondary" onclick="closeModal('loginModal')">å–æ¶ˆ</button>
    </div>
   </div>
  </div><div id="editModal" class="modal">
   <div class="modal-content">
    <h3 id="editTitle">ç·¨è¼¯æ–°è</h3>
    <div class="form-group"><label>ğŸ“… ç™¼å¸ƒæ—¥æœŸï¼š</label> <input type="date" id="editDate" required>
    </div>
    <div class="form-group"><label>ğŸ“° æ–°èæ¨™é¡Œï¼š</label> <textarea id="editNewsTitle" placeholder="è«‹è¼¸å…¥æ–°èæ¨™é¡Œ" required></textarea>
    </div>
    <div class="form-group"><label>âœï¸ ç·¨è¼¯äººå“¡ï¼š</label> <select id="editEditor" required> <option value="">è«‹é¸æ“‡ç·¨è¼¯äººå“¡</option> </select>
    </div>
    <div class="form-group"><label>ğŸ¬ å½±ç‰‡äººå“¡ï¼š</label> <select id="editVideo" required> <option value="">è«‹é¸æ“‡å½±ç‰‡äººå“¡</option> </select>
    </div>
    <div class="form-group"><label>ğŸ¨ å¹³é¢äººå“¡ï¼š</label> <select id="editGraphic" required> <option value="">è«‹é¸æ“‡å¹³é¢äººå“¡</option> </select>
    </div>
    <div class="checkbox-group"><input type="checkbox" id="editAccent"> <label for="editAccent">â­ é‡é»æ–°èï¼ˆç´«è‰²æ¨™ç¤ºï¼‰</label>
    </div>
    <div style="text-align:center; margin-top:32px"><button class="btn" onclick="saveNews()">ğŸ’¾ å„²å­˜</button> <button class="btn danger" onclick="deleteNews()" id="deleteBtn">âœ… å®Œæˆæ–°è</button> <button class="btn secondary" onclick="closeModal('editModal')">å–æ¶ˆ</button>
    </div>
   </div>
  </div><div id="historyModal" class="modal">
   <div class="modal-content" style="width:900px; max-width:95%; max-height:90vh">
    <h3>ğŸ“š æ–°èæ­·å²ç´€éŒ„</h3><div class="staff-section">
     <h4>ğŸ” æœå°‹æ¢ä»¶</h4>
     <div style="display:grid; grid-template-columns:1fr 1fr 2fr auto; gap:12px; margin-bottom:16px"><select id="searchYear"> <option value="">é¸æ“‡å¹´ä»½</option> </select> <select id="searchMonth"> <option value="">é¸æ“‡æœˆä»½</option> <option value="1">1æœˆ</option> <option value="2">2æœˆ</option> <option value="3">3æœˆ</option> <option value="4">4æœˆ</option> <option value="5">5æœˆ</option> <option value="6">6æœˆ</option> <option value="7">7æœˆ</option> <option value="8">8æœˆ</option> <option value="9">9æœˆ</option> <option value="10">10æœˆ</option> <option value="11">11æœˆ</option> <option value="12">12æœˆ</option> </select> <input type="text" id="searchKeyword" placeholder="è¼¸å…¥é—œéµå­—æœå°‹æ¨™é¡Œå…§å®¹..."> <button class="btn" onclick="searchHistory()">æœå°‹</button>
     </div>
     <div style="text-align:center"><button class="btn secondary" onclick="clearSearch()" style="font-size:14px; padding:8px 16px">æ¸…é™¤æ¢ä»¶</button> <span id="searchResults" style="margin-left:16px; color:var(--muted); font-size:14px"></span>
     </div>
    </div><div class="staff-section">
     <h4>ğŸ“° æ­·å²æ–°è (<span id="historyCount">0</span>)</h4>
     <div id="historyList" style="max-height:400px; overflow-y:auto; border:1px solid var(--line); border-radius:8px; padding:16px; background:white"></div>
    </div>
    <div style="text-align:center; margin-top:32px"><button class="btn" onclick="downloadHistoryExcel()" style="background:var(--green); margin-right:12px">ğŸ“¥ ä¸‹è¼‰Excel</button> <button class="btn secondary" onclick="closeModal('historyModal')">é—œé–‰</button>
    </div>
   </div>
  </div><div id="staffModal" class="modal">
   <div class="modal-content" style="width:800px; max-width:95%">
    <h3>ğŸ‘¥ ç®¡ç†å¾Œå°</h3><div class="staff-section">
     <h4>ğŸ“° æ–°èç®¡ç†</h4>
     <div style="text-align:center; margin:16px 0"><button class="btn" onclick="addNews()">â• æ–°å¢æ–°è</button>
     </div>
     <div id="adminNewsList" style="max-height:300px; overflow-y:auto; border:1px solid var(--line); border-radius:8px; padding:16px; background:white"></div>
    </div>
    <div class="staff-section">
     <h4>ğŸ“Š Excelæª”æ¡ˆåŒ¯å…¥</h4>
     <div class="file-upload" onclick="document.getElementById('excelFile').click()"><input type="file" id="excelFile" accept=".xlsx,.xls,.csv" onchange="importExcel(event)">
      <p>ğŸ“ é»æ“Šä¸Šå‚³Excelæª”æ¡ˆ</p><small>æ”¯æ´æ ¼å¼ï¼š.xlsx, .xls, .csv<br>
       æ¬„ä½ï¼šå“¡å·¥ç·¨è™Ÿã€å§“åã€è·ä½ï¼ˆç·¨è¼¯/å½±ç‰‡/å¹³é¢ï¼‰</small>
     </div>
    </div>
    <div class="staff-section">
     <h4>â• æ‰‹å‹•æ–°å¢äººå“¡</h4>
     <div style="display:grid; grid-template-columns:1fr 1fr 1fr auto; gap:12px; margin-bottom:16px"><input type="text" id="staffId" placeholder="å“¡å·¥ç·¨è™Ÿ"> <input type="text" id="staffName" placeholder="å§“å"> <select id="staffRole"> <option value="editor">ç·¨è¼¯</option> <option value="video">å½±ç‰‡</option> <option value="graphic">å¹³é¢</option> </select> <button class="btn" onclick="addStaff()">æ–°å¢</button>
     </div>
    </div>
    <div class="staff-section">
     <h4>âœï¸ ç·¨è¼¯äººå“¡ (<span id="editorCount">0</span>)</h4>
     <div id="editorList" class="staff-list"></div>
    </div>
    <div class="staff-section">
     <h4>ğŸ¬ å½±ç‰‡äººå“¡ (<span id="videoCount">0</span>)</h4>
     <div id="videoList" class="staff-list"></div>
    </div>
    <div class="staff-section">
     <h4>ğŸ¨ å¹³é¢äººå“¡ (<span id="graphicCount">0</span>)</h4>
     <div id="graphicList" class="staff-list"></div>
    </div>
    <div style="text-align:center; margin-top:32px"><button class="btn" onclick="closeModal('staffModal')">âœ… å®Œæˆ</button>
    </div>
   </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
// åˆå§‹è³‡æ–™
let newsData = [
  {
    id: 1,
    date: '2024-08-12',
    title: 'å½°åŸºæ”œæ‰‹ä¸­èˆˆå¤§å­¸é†«å­¸é™¢ã€€å‚³æ‰¿é†«ç™‚ä½¿å‘½ã€è½å¯¦åœ¨åœ°é—œæ‡·',
    editor: '109899',
    video: '155125',
    graphic: '180712',
    accent: true
  },
  {
    id: 2,
    date: '2024-08-13',
    title: 'é¹¿æ¸¯åŸºç£æ•™é†«é™¢é˜²é¢±é€Ÿå ±ã€€è‡´è´ˆç§‘æŠ€æ²™åŒ…é˜²ç¯„æ¥ŠæŸ³é¢±é¢¨ä¾µè¥²',
    editor: '53620',
    video: '155125',
    graphic: '72760',
    accent: false
  },
  {
    id: 3,
